<div class="row">
    <div class="content-wrapper-before gradient-45deg-green-teal gradient-shadow "></div>
    <div class="col s12">
        <div class="container">



<div class="hide">
  <a class="waves-effect waves-light btn modal-trigger" id="hidem2" href="#modal1" onclick="setTimeout(carga,2000);">Modal</a>
</div>

  
  <div id="modal1" class="modal " style="padding-top: 12 rem;">
      <div class="center" >
 Añadiendo pregunta...
    <div class="modal-content">
      <div class="preloader-wrapper big active">
    <div class="spinner-layer spinner-blue-only">
      <div class="circle-clipper left">
        <div class="circle"></div>
      </div><div class="gap-patch">
        <div class="circle"></div>
      </div><div class="circle-clipper right">
        <div class="circle"></div>
      </div>
    </div>
      </div>
     
  </div>

  <div class="hide">
   <a href="#!" id="hidem" class="modal-close waves-effect waves-green btn-flat">Agree</a>
  </div>
 </div>
    
    
  </div>

            <!-- invoice list -->
            <section class="invoice-list-wrapper section">
                <!-- create invoice button-->
                <!-- Options and filter dropdown button-->
                <!-- create invoice button-->
                <div class="row">
                    <div class="container">
                        <div class="col s6">
                             <button class="btn waves-effect waves-light deep-purple accent-1" name="action"
                                                    href="#modal3" id="send">
                                                    <i class="fas fa-edit"></i>
                                                    <a class="modal-trigger btn-flat" href="#modal3">Agregar</a>  
                                                    </button>
                        </div>
                        <div class="col s6 deep-purple accent-1 border-radius-10">
                            <input type="text" id="correo_cambiar_tipo" placeholder="Correo electronico">
                            <select id="modificar_tipo_usuario">
                    <option value="" disabled selected>Cambiar tipo de usuario</option>
                    <option value="1">Alumno</option>
                    <option value="2">Tutor</option>
                    <option value="3">Profesor</option>
                    <option value="4">Autoridad</option>
                </select>
                            <button class="btn waves-effect waves-light deep-purple accent-2" onclick="cambiarTipoUsuario('correo_cambiar_tipo', 'modificar_tipo_usuario');">
                    <i class="fas fa-edit"></i>
                    <a class="white-text">Modificar</a>  
                </button><br><br>
                        </div>
                    </div>
                </div>
                
                
                <h3>Usuarios</h3>
                <div class="responsive-table">
                    <div class="dataTables_wrapper no-footer">
                        <div class="top display-flex mb-2">
                            <div class="action-filters">
                                <div class="dataTables_filter">
                                    <label>
                                        <input type="search"
                                            placeholder="Buscar"
                                            id="busqueda_grupo"
                                            onkeyup="barraBusqueda('busqueda_grupo','tabla_usu');">
                                    </label>
                                </div>

                            </div>
                        </div>
                    </div>
                </div>
                <table class="responsive-table highlight">
                    <thead>
                        <tr>
                            <td>Nombre</td>
                            <td>Correo</td>
                            <td>Tipo de usuario</td>
                            <td colspan="2">Acciones</td>
                        </tr>
                    </thead>
                     <tbody id="tabla_usu">
                                        {{#each usuariosRetorno}}
                                        <tr>
                                            <td  contenteditable="true" id="nom_usu{{id_usu}}">{{nom_usu}}</td>
                                            <td  contenteditable="true" id="cor_usu{{id_usu}}">{{cor_usu}}</td>
                                            <td>{{cat_tus}}</td>
                                            <td>
                                                <a href="javascript:void(0);" onclick="modificarUsuario({{id_usu}}, document.getElementById('nom_usu{{id_usu}}').innerText,document.getElementById('cor_usu{{id_usu}}').innerText);" class="waves-effect waves-teal btn-flat">Modificar usuario</a>
                                            </td>
                                            <td>
                                                <a href="javascript:void(0);" onclick="eliminarUsuario({{id_usu}});" class="waves-effect waves-teal btn-flat">Eliminar</a>
                                            </td>
                                        </tr>

                                        {{else}}
                                        <tr>
                                            <td>---</td>
                                            <td>---</td>
                                            <td>---</td>
                                            <td>---</td>
                                            <td>---</td>
                                            <td>---</td>
                                            <td>---</td>
                                        </tr>
                                        {{/each}}
                                    </tbody>
                                </table>
                                 <!-- create invoice button-->
            </section>
            <!-- START RIGHT SIDEBAR NAV -->
            <aside id="right-sidebar-nav">
                <div id="slide-out-right" class="slide-out-right-sidenav sidenav
                    rightside-navigation right-aligned">
                    <div class="row">
                        <div class="slide-out-right-title">
                            <div class="col s12 border-bottom-1 pb-0 pt-1">
                                <div class="row">
                                    <div class="col s2 pr-0 center">
                                        <i class="material-icons
                                            vertical-text-middle"><a href="#"
                                                class="sidenav-close">clear</a></i>
                                    </div>
                                    <div class="col s10 pl-0">
                                        <ul class="tabs">
                                            <li class="tab col s4 p-0">
                                                <a href="#reportes"
                                                    class="active">
                                                    <span>Reportes</span>
                                                </a>
                                            </li>
                                            <li class="indicator" style="left:
                                                0px; right: 188px;"></li></ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="slide-out-right-body row pl-3 ps
                            ps--active-y">
                            <div id="reportes" class="col s12 pb-0 active">
                                <div class="collection border-none mb-0">
                                    <ul class="collection right-sidebar-chat p-0
                                        mb-0">
                                        <a href="javascript:void(0);">
                                            <li class="collection-item
                                            right-sidebar-chat-item
                                            display-flex avatar
                                            pl-5 pb-0"
                                            data-target="slide-out-chat">
                                                <i class="material-icons">chrome_reader_mode</i>
                                            </span>
                                            <div class="user-content">
                                                <h6 class="line-height-0">Reporte 1IV2</h6>
                                            </div>
                                            <span class="secondary-content
                                                medium-small">29-02-20</span>
                                            </li>
                                        </a>
                                        <a href="javascript:void(0);">
                                        <li class="collection-item
                                            right-sidebar-chat-item
                                            sidenav-trigger display-flex avatar
                                            pl-5 pb-0"
                                            data-target="slide-out-chat">
                                                <i class="material-icons">chrome_reader_mode</i>
                                            </span>
                                            <div class="user-content">
                                                <h6 class="line-height-0">Reporte 1IV3</h6>
                                            </div>
                                            <span class="secondary-content
                                                medium-small">28-02-20</span>
                                        </li>
                                        </a>
                                    </ul>
                                </div>
                            </div>
                            
                            <div class="ps__rail-x" style="left: 0px; bottom:
                                0px;"><div class="ps__thumb-x" tabindex="0"
                                    style="left: 0px; width: 0px;"></div></div><div
                                class="ps__rail-y" style="top: 0px; height:
                                624px; right: 0px;"><div class="ps__thumb-y"
                                    tabindex="0" style="top: 0px; height:
                                    308px;"></div></div></div>
                    </div>
                </div>

            </aside>
            <!-- END RIGHT SIDEBAR NAV -->
        </div>
        <div class="content-overlay"></div>
    </div>
</div>
<div id="modal3" class="modal">
    <div class="modal-content">
        <h4>Registro</h4>
            <div class="row">
                <div class="input-field col s6">
                    <input id="first_name" name="nombres_usuario" type="text" class="validate">
                    <label for="first_name">Nombres</label>
                            <b><span style="color:#FF0000" class="label-input100"id="anombre"></span></b>

                </div>
                <div class="input-field col s6">
                    <input id="last_name" name="apellidos_usuario" type="text" class="validate">
                    <label for="last_name">Apellidos</label>
                </div>
                        <b><span style="color:#FF0000" class="label-input100"id="aapmat"></span></b>

            </div>
            <div class="row">
                <div class="input-field col s12">
                    <select id="tip_usu" name="tipo_usuario">
                        <option value="" disabled selected>Escoge tu opción</option>
                        <option value=3>Profesor</option>
                        <option value=5>Administrador</option>
                        <option value=4>Autoridad</option>
                    </select>
                    <label>Tipo de cuenta</label>
                    <b><span style="color:#FF0000" class="label-input100"id="atipo"></span></b>
                </div>
            </div>
            
            <div class="row">
                <div class="input-field col s12">
                    <input id="email" name="email_usuario" type="email" class="validate">
                    <label for="email">Email</label>
                    <b><span style="color:#FF0000" class="label-input100"id="aemail"></span></b>
                </div>
            </div>
            <div class="row">
                <div class="input-field col s12">
                    <input id="password" name="contraseña_usuario" type="password" class="validate">
                    <label for="password">Password</label>
                   <b><span style="color:#FF0000" class="label-input100"id="apas"></span></b>
                </div>
            </div>
            <a href="javascript:void(0);" id="sendd" class="waves-effect waves-teal btn-flat">Registrar Usuario</a>
           
            <a href="#!" class="modal-close waves-effect waves-green btn-flat">Cerrar</a>
        </form>
        
    </div>
</div>
            <script>
                window.addEventListener('load', () => {
                    setTimeout(carga, 50);
                    function carga() {
                        document.getElementById('loadercircle').className = 'hide';
                        document.getElementById('contents').className = 'animated fadeIn';
                    }

                })
                const resultado = document.getElementById('resultados');
                document.addEventListener('DOMContentLoaded', function () {
                    var elems = document.querySelectorAll('.sidenav');
                    var instances = M.Sidenav.init(elems);
                    var elems = document.querySelectorAll('.carousel');
                    var instances = M.Carousel.init(elems);
                    var elems = document.querySelectorAll('.modal');

                    var instances = M.Modal.init(elems);
                    var options = {
                        data: {
                            "Microsoft": null,
                            "Alvin": null
                        },
                        onAutocomplete: function (texto) {
                            resultado.innerHTML = `Resultado: ${texto}`;
                        }
                    }
                    var elems = document.querySelectorAll('.autocomplete');
                    var instances = M.Autocomplete.init(elems, options);
                    var elems = document.querySelectorAll('.parallax');
                    var instances = M.Parallax.init(elems, responsiveThreshold = 100);
                });



                // Initialize collapsible (uncomment the lines below if you use the dropdown variation)
                // var collapsibleElem = document.querySelector('.collapsible');
                // var collapsibleInstance = M.Collapsible.init(collapsibleElem, options);

                // Or with jQuery

                $(document).ready(function () {
                    $('.sidenav').sidenav();
                });

            </script>
            <script>
                function myFunction() {
                    // Declare variables
                    var input, filter, table, tr, td, i, txtValue;
                    input = document.getElementById("autocomplete-input");
                    filter = input.value.toUpperCase();
                    table = document.getElementById("myTable");
                    tr = table.getElementsByTagName("tr");

                    // Loop through all table rows, and hide those who don't match the search query
                    for (i = 0; i < tr.length; i++) {
                        td = tr[i].getElementsByTagName("td")[0];
                        if (td) {
                            txtValue = td.textContent || td.innerText;
                            if (txtValue.toUpperCase().indexOf(filter) > -1) {
                                tr[i].style.display = "";
                            } else {
                                tr[i].style.display = "none";
                            }
                        }
                    }
                }
            </script>
            <script>
                let enviar=document.getElementById('sendd'); 
 
                function retrono(){
                    let nombre=document.getElementById('first_name').value; 
                    let materno=document.getElementById('last_name').value; 
                    let sexo=1;
                    let tusuario=document.getElementById('tip_usu').value; 
                    
                    
                    let correo=document.getElementById('email').value; 
                    let contraseña=document.getElementById('password').value; 
                    /*-----------------------------*/
                    let vnombre=validarnombreapellido(nombre,"nombre"); 
                    if(vnombre==true){
                        document.getElementById('anombre').innerHTML=""; 
                            let vmaterno=validarnombreapellido(materno, "apellido materno");
                            if(vmaterno==true){ 
                                document.getElementById('aapmat').innerHTML=""; 
                                if(sexo!="1"){ 
                                    document.getElementById('asex').innerHTML="Sexo es inválido";
                                    return false
                                }else{
                                    if(tusuario!=3 &&  tusuario!= 5&&  tusuario!= 4){
                                        console.log('f');
                                        document.getElementById('atipo').innerHTML="Tipo de usuario inválido";
                                        return false
                                    }else{
                                        document.getElementById('atipo').innerHTML="";
                                            let vemail=validarEmail(correo);
                                            if(vemail==true){
                                                document.getElementById('aemail').innerHTML="";
                                                let vcontraseña=ValidarContraseña(contraseña);
                                                if(vcontraseña){
                                                    document.getElementById('apas').innerHTML=""; 
                                                    carga2();

                                                }else{
                                                    document.getElementById('apas').innerHTML="Entre 8-50 caracteres-Al menos una letra mayúscula-Al menos una letra minuscula-Al menos un dígito-No espacios en blanco-Al menos 1 caracter especial";
                                                    
                                                    return false; 
                                                }
                                            }else{
                                                document.getElementById('aemail').innerHTML=vemail;
                                                return false; 
                                            }
                                    }
                                }
                            }else{
                                document.getElementById('aapmat').innerHTML=vmaterno; 
                                return false;
                            }

                    }else{
                        document.getElementById('anombre').innerHTML=vnombre; 
                        return false; 
                    }
                    
                }



                function validarnombreapellido(nombre, tipo){
                    var reNomA= /^[a-zA-ZÀ-ÿ\u00f1\u00d1]+(\s*[a-zA-ZÀ-ÿ\u00f1\u00d1]*)*[a-zA-ZÀ-ÿ\u00f1\u00d1]+$/
                    
                if(tipo=="apellido materno"){
                        let spaceApp=nombre.split(' ');
                        
                        if(spaceApp.length!=2){
                            return "Coloca Ambos apellidos"
                        }else{
                            return true

                        }
                    }
                    if (nombre.length<3 || nombre.length>50){
                        if(tipo=="apellido materno" ){
                            return "Los apellidos deben estar entre 3 y 50 caracteres"
                        }else{
                            return "El nombre debe estar entre 3 y 50 caracteres"
                        }
                    }else{
                        if(!reNomA.test(nombre)){

                            if(tipo=="apellido materno" ){
                                
                                    return "Los Apellidos sólo deben contener letras"

                            }else{
                                return "El nombre sólo debe contener letras"
                            }
                        }else{
                            return true; 
                        }
                    } 
                }



                function validarEmail(email) { 
                    if(email.length<1){
                        return "El correo no puede estar vacío"; 
                    }else{
                        var reCorreo= /^[a-zA-ZÀ-ÿ\u00f1\u00d10-9._-]+@[a-zA-ZÀ-ÿ\u00f1\u00d10-9.-]+\.([a-zA-ZÀ-ÿ\u00f1\u00d1]{2,4})+$/

                        if(!reCorreo.test(email)){
                            return "El correo Es inválido"

                        }else{
                            return true; 

                        }
                    } 
                }

                function validacaracteres(carac, val){
                    let arreglo = [];
                    a = true;
                    for (let i = 0; i < val.length; i++) {
                        arreglo[i] = false;
                    }
                    for (let i = 0; i < val.length; i++) {
                        for (let j = 0; j < carac.length; j++) {
                            if (val.charAt(i) == carac.charAt(j)) {
                                arreglo[i] = true;
                                break;
                            }
                        }
                        if (arreglo[i] == false) {
                            a = false;
                            break; 
                        }
                    }
                    return a;
                }

                function ValidarContraseña(contraseña){
                
                var reContra= /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[$@$!%*?&])([A-Za-z\d$@$!%*?&]|[^ ]){8,50}$/;
                    if(!reContra.test(contraseña)){ 
                        return false;
                        
                    }else{
                        return true;
                    }
                }

                enviar.addEventListener('click', (e)=>{
                    if(!retrono()){
                        e.preventDefault(); 
                    }
                }, false); 


            </script>
<script>


function carga(){
   AgregarUsuarioAjax(document.getElementById('first_name').value, document.getElementById('last_name').value,document.getElementById('tip_usu').value,document.getElementById('email').value,document.getElementById('password').value);
};
function carga2(){
    document.getElementById('hidem2').click();
};

</script>
            